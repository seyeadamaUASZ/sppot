<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout">
<head>
<meta charset="utf-8">
<title>Gestion des documents liés aux indicateurs</title>
</head>
<body>
<div layout:fragment="content">

<div class="page-title">
              <div class="title_left">
                <h5>Liste des documents</h5>
              </div>

              <div class="title_right">
                <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                  <div class="input-group">
                    <input type="text" class="form-control" placeholder="Recchercher...">
                    <span class="input-group-btn">
                      <button class="btn btn-secondary" type="button"> <i class="fa fa-search"></i> </button>
                    </span>
                  </div>
                </div>
              </div>
            </div>
<div class="row">
  
      <div class="col-md-12 col-sm-12 ">
                <div class="x_panel">
                  <div class="x_title">
                    <h6> <i class="fa fa-folder"></i> </h6>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="#">Settings 1</a>
                            <a class="dropdown-item" href="#">Settings 2</a>
                          </div>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                      <div class="row">
                          <div class="col-sm-12">
                            <div class="card-box table-responsive">
                    <table id="datatable" class="table table-striped table-bordered" style="width:100%">
                      <thead>
                        <tr>
                            <th></th>
                            <th>Id</th>
                            <th>Nom fichier</th>
                            <th>Date d'entree</th>
                            <th>Categorie</th>
                            <th>Motcles</th>
                           <th>Status document</th>
                          
                        </tr>
                      </thead>
                      <tbody> 
                        <tr th:each="d: ${documents}">
                               <td>
                                    <a th:href="@{getdoc/(id=${d.id})}" class="btn btn-default act1"> <i class="fa fa-edit"></i></a>
                                </td>
                               <td th:text="${d.id}"></td>
                               <td th:text="${d.fileName}"></td>
                               <td th:text="${d.dateFile}"></td>
                                <td th:text="${d.categorieDocument.namecategorie}"></td>
                               <td th:text="${d.motcles}"></td>
                               
                               <td class="rep" th:text="${d.status}"></td>
                                
                            </tr>
                      </tbody>
                    </table>
                  </div>
                  </div>
              </div>
            </div>
                </div>
            </div>
            
            <div class="col-md-12 col-sm-12 myForm">
             <div class="x_panel">
				<div class="x_title">
					<h2> <i class="fa fa-edit"></i>Ajout/Modification</h2>
					<ul class="nav navbar-right panel_toolbox">
						<li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
						</li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-wrench"></i></a>
							<ul class="dropdown-menu" role="menu">
								<li><a class="dropdown-item" href="#">Settings 1</a>
								</li>
								<li><a class="dropdown-item" href="#">Settings 2</a>
								</li>
							</ul>
						</li>
						<li><a class="close-link"><i class="fa fa-close"></i></a>
						</li>
					</ul>
					<div class="clearfix"></div>
				</div>
				<div class="x_content">
					<br />
					<form  th:action="@{/uploadFile}" method="post" enctype="multipart/form-data">
					    <input type="hidden" id="id" name="id" required="required"  class="form-control">
					    
					    <div class="item form-group">
							<label for="middle-name" class="col-form-label col-md-3 col-sm-3 label-align">Status doc</label>
							<div class="col-md-6 col-sm-6 ">
								<select class="form-control app" id="statusdoc" name="statusdoc">
                                    <option  th:value="false">Non archivé</option>
                                    <option  th:value="true">Archivé</option>
                                   </select>
							</div>
						</div>
						
						<div class="item form-group">
							<label for="middle-name" class="col-form-label col-md-3 col-sm-3 label-align">Categorie</label>
							<div class="col-md-6 col-sm-6 ">
								<select class="form-control app" id="categorie" name="idc">
                                   <option th:each="c:${categories}" th:value="${c.id}" th:text="${c.namecategorie}" value=""></option>
                                   </select>
							</div>
						</div>
						
						<div class="item form-group">
							<label class="col-form-label col-md-3 col-sm-3 label-align" for="last-name">Mot clés <span class="required">*</span>
							</label>
							<div class="col-md-6 col-sm-6 ">
								<input type="text" id="motcles" name="motcles" required="required"  class="form-control" value="">
							</div>
						</div>
						
						<div class="item form-group">
							<label class="col-form-label col-md-3 col-sm-3 label-align" for="first-name">Fichier<span class="required">*</span>
							</label>
							<div class="col-md-6 col-sm-6 ">
								 <input type="file" class="form-control" id="file" name="file" value=""/> <label id="file1"></label>
							</div>
						</div>
						
						
						<div class="ln_solid"></div>
						<div class="item form-group">
							<div class="col-md-6 col-sm-6 offset-md-3">
								<button class="btn btn-danger" type="button">Annuler</button>
								<button class="btn btn-info" type="reset">Effacer</button>
								<button type="submit" class="btn btn-success">Ajouter</button>
							</div>
						</div>

						</form>
					</div>
				</div>            	
            </div>                        
  </div>
  <script src="vendor1/jquery/dist/jquery.min.js"></script>
  
  <script type="text/javascript">
   $(document).ready(function(event){
	   console.log('Hello wordl !!'); 
	   
	   $('.act1').on('click', function(event) {
           event.preventDefault();  
           var href = $(this).attr('href');
           $.get(href, function(doc){
           var selectElmt = document.getElementById("statusdoc");	  
           var niveau =selectElmt.options[selectElmt.selectedIndex].text;
           console.log(niveau)
           $('.myForm #id').val(doc.id)
           $('.myForm #motcles').val(doc.motcles)
           $('.myForm #idc').val(doc.categorieDocument.id)
           //$('.myForm #statusdoc').val(doc.statusdoc) 
           //$('.myForm #statusdoc').textContent = niveau;
           console.log($('.myForm #statusdoc').text())
           document.getElementById("file1").textContent=doc.fileName;
          
        
           })
        })
        
        $("tr").each(function(i) {
            var nada = $(this).find('.rep').text();
            if ($(this).find('.rep').text() === 'false') {
                $(this).find('.rep').textContent ="Non archivé";
               
            }
            if ($(this).find('.rep').text() === 'Archivé') {
            	 $(this).find('.rep').css('background-color', 'red');  
            }

        });
   });
  </script>
 
</div>

</body>
</html>